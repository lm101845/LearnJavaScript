# SessionId有关问题



## 保存地点

Session ID可以存储在cookie中，这也是最常见的方式，但也可以存储在localStorage或sessionStorage中。

当session ID存储在localStorage或sessionStorage中时，它们可以在浏览器的会话期间保持有效，但一旦浏览器关闭或会话超时，这些存储的数据就会被清除。如果需要在浏览器重新打开时恢复会话状态，那么在浏览器重新打开时，需要重新创建session ID并将其存储在localStorage或sessionStorage中。

需要注意的是，如果将session ID存储在localStorage或sessionStorage中，可能会存在安全性问题，因为这些数据可以被用户查看和修改。因此，对于安全性要求较高的应用，建议使用cookie来存储session ID。

## sessionID存在sessionStorage中，浏览器重新打开，sesssionId就没有了，此时服务器中的session还在有效期内，这样成功发送请求，可以拿到数据吗

### 客户端用cookie保存了sessionID

  客户端用cookie保存了sessionID，当我们请求服务器的时候，会把这个sessionID一起发给服务器，服务器会到内存中搜索对应的sessionID，如果找到了对应的 sessionID，说明我们处于登录状态，有相应的权限；如果没有找到对应的sessionID，这说明：要么是我们把浏览器关掉了（后面会说明为什 么），要么session超时了（没有请求服务器超过20分钟），session被服务器清除了，则服务器会给你分配一个新的sessionID。你得重 新登录并把这个新的sessionID保存在cookie中。 
在没有把浏览器关掉的时候（这个时候假如已经把sessionID保存在cookie中了）这个sessionID会一直保存在浏览器中，每次请求的时候都会把这个sessionID提交到服务器，所以服务器认为我们是登录的；当然，如果太长时间没有请求服务器，服务器会认为我们已经所以把浏览器关掉了，这个时候服务器会把该sessionID从内存中清除掉，这个时候如果我们再去请求服务器，sessionID已经不存在了，所以服务器并没有在内存中找到对应的 sessionID，所以会再产生一个新的sessionID，这个时候一般我们又要再登录一次。 

### 客户端没有用cookie保存sessionID

这个时候如果我们请求服务器，因为没有提交sessionID上来，服务器会认为你是一个全新的请求，服务器会给你分配一个新的sessionID，这就是 为什么我们每次打开一个新的浏览器的时候（无论之前我们有没有登录过）都会产生一个新的sessionID（或者是会让我们重新登录）。 
当我们一旦把浏览器关掉后，再打开浏览器再请求该页面，它会让我们登录，这是为什么？我们明明已经登录了，而且还没有超时，sessionID肯定还在服 务器上的，为什么现在我们又要再一次登录呢？这是因为我们关掉浏览再请求的时候，我们提交的信息没有把刚才的sessionID一起提交到服务器，所以服 务器不知道我们是同一个人，所以这时服务器又为我们分配一个新的sessionID,打个比方：浏览器就好像一个要去银行开户的人，而服务器就好比银行， 这个要去银行开户的人这个时候显然没有帐号（sessionID），所以到银行后，银行工作人员问有没有帐号，他说没有，这个时候银行就会为他开通一个帐 号。所以可以这么说，每次打开一个新的浏览器去请求的一个页面的时候，服务器都会认为，这是一个新的请求，他为你分配一个新的sessionID。

## 为什么重启浏览器后，session id变了，却能保持登录状态

即使重启浏览器后，session ID变了，用户仍能保持登录状态，这是因为服务器端产生session ID，并将该ID发送给客户端（浏览器），浏览器将该ID存储在会话存储（sessionStorage）中。当浏览器重新打开时，会话存储中的session ID将会丢失，但是服务器端的会话仍然存在，并且服务器可以利用该会话信息来判断用户是否登录。

为了在浏览器重新打开后保持登录状态，可以在cookie或URL查询参数中传递会话ID，以便在客户端重新发送给服务器。此外，即使session ID变了，服务器可以利用已存储的会话信息来判断用户是否登录，例如检查数据库中的登录状态或通过其他方式验证用户的身份。

因此，即使浏览器重新打开后session ID变了，用户仍能保持登录状态，因为服务器可以利用已存储的会话信息来验证用户身份并保持登录状态。