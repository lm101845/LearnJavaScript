# ä½ ä¸çŸ¥é“çš„ JSON.stringify() çš„å¨åŠ›

> é“¾æ¥ï¼šhttps://juejin.cn/post/6844904016212672519#heading-27

# å‰è¨€

å…¶å®æœ‰å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ï¼Œå½“æ—¶å­¦ä¹ äº†ï¼Œä¹Ÿè®°ä½äº†ï¼Œä½†æ˜¯æ—¶é—´ä¹…äº†å°±æ˜¯è®°ä¸ä½ï¼Œæ‰€ä»¥å¯¼è‡´åœ¨æ—¥å¸¸å¼€å‘ä¸­æ€»æ˜¯æƒ³ä¸èµ·æ¥åŸæ¥è¿™ä¸ªä¸œè¥¿å¯ä»¥è¿™ä¹ˆç”¨ï¼Œè€Œå»é€‰æ‹©äº†æ›´åŠ å¤æ‚å’Œéº»çƒ¦çš„æ–¹å¼ã€‚å…¶å®æˆ‘ä»¬æ—¥å¸¸å­¦ä¹ çš„çŸ¥è¯†å°±æ˜¯æ‹¿æ¥ç”¨çš„ï¼Œå³ä½¿ä½ ä»Šå¤©æŠŠçŸ¥è¯†ç‚¹èƒŒä¸‹æ¥äº†ï¼Œæ²¡æœ‰å»æ€è€ƒè¿™ä¸ªçŸ¥è¯†ç‚¹æˆ‘ä»¬å¯ä»¥ç”¨æ¥å¹²å˜›ï¼Œä¸éœ€è¦å‡ å¤©å°±ä¼šæ…¢æ…¢åœ°å¿˜æ‰ã€‚æ‰€ä»¥ä»Šå¤©æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹åœ¨æ—¥å¸¸å­¦ä¹ æ—¶ä½ é—æ¼æ‰æˆ–è€…å¿˜æ‰æˆ–è€…æ²¡æœ‰æ€è€ƒè¿‡çš„ä½ ä¸çŸ¥é“çš„ `JSON.stringify()` çš„å¨åŠ›ã€‚

> [åŸæ–‡æˆ³æˆ‘](https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FNieZhuZhu%2FBlog%2Fissues%2F1)

# é€šè¿‡éœ€æ±‚å­¦ä¹ `JSON.stringify()`

é¦–å…ˆæˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹å½“ä¸­é‡åˆ°è¿™æ ·ä¸€ä¸ªå¤„ç†æ•°æ®çš„éœ€æ±‚

```
const todayILearn = {
  _id: 1,
  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
  created_at: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
  updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)'
}
å¤åˆ¶ä»£ç 
```

æˆ‘ä»¬éœ€è¦å°†ä¸Šé¢è¿™ä¸ªå¯¹è±¡å¤„ç†æˆä¸‹é¢è¿™ä¸ªå¯¹è±¡

```
const todayILearn = {
  id: 1,
  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
  updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)'
}
å¤åˆ¶ä»£ç 
```

ä¹Ÿå°±æ˜¯åœ¨ä¸æ”¹å˜å±æ€§çš„å€¼çš„å‰æä¸‹ï¼Œå°†å¯¹è±¡å±æ€§ä¿®æ”¹ä¸€ä¸‹ã€‚ æŠŠ`_id` æ”¹æˆ `id`ï¼ŒæŠŠ `updated_at` æ”¹æˆ `updatedAt`ï¼ŒæŠŠ `created_at` æ”¹æˆ `createdAt`ã€‚æˆ‘ä»¬ç°åœ¨é€šè¿‡è¿™ä¸ªå°å°çš„éœ€æ±‚æ¥è§è¯†ä¸€ä¸‹ `JSON.stringify()` çš„å¼ºå¤§å§ã€‚

é¦–å…ˆè¦è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æœ‰å¾ˆå¤šç§è§£å†³æ–¹å¼ï¼Œæˆ‘ä»¬å…ˆæä¾›ä¸¤ç§ä¸ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š

- **æ–¹æ¡ˆä¸€ï¼šä¸€æ¬¡éå†+å¤šå£°æ˜ä¸€ä¸ªå˜é‡**

```
// å¤šä¸€ä¸ªå˜é‡å­˜å‚¨
const todayILearnTemp = {};
for (const [key, value] of Object.entries(todayILearn)) {
  if (key === "_id") todayILearnTemp["id"] = value;
  else if (key === "created_at") todayILearnTemp["createdAt"] = value;
  else if (key === "updatedAt") todayILearnTemp["updatedAt"] = value;
  else todayILearnTemp[key] = value;
}
console.log(todayILearnTemp);
// ç»“æœï¼š
// { id: 1,
//  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
//  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
//  updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' 
// }
å¤åˆ¶ä»£ç 
```

æ–¹æ¡ˆä¸€å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥å®ç°ã€‚ä½†æ˜¯å¤šå£°æ˜äº†ä¸€ä¸ªå˜é‡åˆåŠ ä¸Šä¸€å±‚å¾ªç¯å¹¶ä¸”è¿˜æœ‰å¾ˆå¤šçš„ `if` `else` è¯­å¥ï¼Œæ€ä¹ˆéƒ½æ˜¾å¾—ä¸å¤ªä¼˜é›…ã€‚

- **æ–¹æ¡ˆäºŒï¼šæš´åŠ› delete å±æ€§å’Œå¢åŠ å±æ€§**

```
// æè‡´çš„æš´åŠ›ç¾å­¦
todayILearn.id = todayILearn._id;
todayILearn.createdAt = todayILearn.created_at;
todayILearn.updatedAt = todayILearn.updated_at;
delete todayILearn._id;
delete todayILearn.created_at;
delete todayILearn.updated_at;
console.log(todayILearn);
// 	å¤ªæš´åŠ›ğŸ˜¢
//{ 
//  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
//  id: 1,
//  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
//  updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' 
//}
å¤åˆ¶ä»£ç 
```

ç›´æ¥ delete æš´åŠ›è§£å†³å¤ªç²—é²äº†ï¼Œè€Œä¸”æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå±æ€§çš„é¡ºåºå˜äº†ã€‚

- **æ–¹æ¡ˆä¸‰ï¼šåºåˆ—åŒ–+ replace ç¾å­¦å…¸èŒƒ**

```
const mapObj = {
  _id: "id",
  created_at: "createdAt",
  updated_at: "updatedAt"
};
JSON.parse(
  JSON.stringify(todayILearn).replace(
    /_id|created_at|updated_at/gi,
    matched => mapObj[matched])
    )

// { 
// id: 1,
//  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
//  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
//  updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' 
// }
å¤åˆ¶ä»£ç 
```

ç¬é—´æ„Ÿè§‰éå¸¸ä¼˜é›…å’Œèˆ’æœï¼Œæœ‰æœ¨æœ‰ï¼

æ¥ä¸‹æ¥ï¼Œæ­£ç‰‡å¼€å§‹ï¼Œæˆ‘ä»¬ä»Šå¤©å°†ç³»ç»Ÿçš„å­¦ä¹ æˆ–è€…è¯´æ˜¯å¤ä¹ ä¸€é `JSON.stringify` çš„åŸºç¡€çŸ¥è¯†ï¼Œè®©æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­æ›´åŠ çš„æ¸¸åˆƒæœ‰ä½™ã€‚

------



![img](https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/12/8/16ee5ace18ca5dbb~tplv-t2oaga2asx-watermark.awebp)



# `JSON.stringify()` ä¹å¤§ç‰¹æ€§

## `JSON.stringify()`ç¬¬ä¸€å¤§ç‰¹æ€§

**å¯¹äº undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä¸‰ä¸ªç‰¹æ®Šçš„å€¼åˆ†åˆ«ä½œä¸ºå¯¹è±¡å±æ€§çš„å€¼ã€æ•°ç»„å…ƒç´ ã€å•ç‹¬çš„å€¼æ—¶ JSON.stringify()å°†è¿”å›ä¸åŒçš„ç»“æœã€‚**

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹çŸ¥è¯†ç‚¹ï¼Œçœ‹ä¸€é“éå¸¸ç®€å•çš„é¢è¯•é¢˜ç›®ï¼šè¯·é—®ä¸‹é¢ä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ

```
const data = {
  a: "aaa",
  b: undefined,
  c: Symbol("dd"),
  fn: function() {
    return true;
  }
};
JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ

// "{"a":"aaa"}"
å¤åˆ¶ä»£ç 
```

å¾ˆç®€å•è¿™é“é¢˜ç›®é¢è¯•å®˜ä¸»è¦è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯ï¼š

- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºå¯¹è±¡å±æ€§å€¼æ—¶ `JSON.stringify()` å°†è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å¯¹å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–

**é¢è¯•å®˜è¿½é—®**ï¼šå‡è®¾ `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` å€¼ä½œä¸ºæ•°ç»„å…ƒç´ ä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿ

```
JSON.stringify(["aaa", undefined, function aa() {
    return true
  }, Symbol('dd')])  // è¾“å‡ºï¼šï¼Ÿ

// "["aaa",null,null,null]"
å¤åˆ¶ä»£ç 
```

çŸ¥è¯†ç‚¹æ˜¯ï¼š

- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼Œ`JSON.stringify()` ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º `null`

æˆ‘ä»¬ç¨å¾®å†åŠ¨ä¸‹è„‘ç­‹ï¼Œå¦‚æœå•ç‹¬åºåˆ—åŒ–è¿™äº›å€¼ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ç»“æœå‘¢ï¼Ÿ

```
JSON.stringify(function a (){console.log('a')})
// undefined
JSON.stringify(undefined)
// undefined
JSON.stringify(Symbol('dd'))
// undefined
å¤åˆ¶ä»£ç 
```

å•ç‹¬è½¬æ¢çš„ç»“æœå°±æ˜¯ï¼š

- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` è¢« `JSON.stringify()` ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶éƒ½ä¼šè¿”å› `undefined`

### `JSON.stringify()` ç¬¬ä¸€å¤§ç‰¹æ€§æ€»ç»“

- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºå¯¹è±¡å±æ€§å€¼æ—¶ `JSON.stringify()` å¯¹è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–
- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼Œ`JSON.stringify()` å°†ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º `null`
- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` è¢« `JSON.stringify()` ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œéƒ½ä¼šè¿”å› `undefined`

## `JSON.stringify()` ç¬¬äºŒå¤§ç‰¹æ€§

ä¹Ÿæ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­å¿…é¡»è¦éå¸¸æ³¨æ„çš„ä¸€ä¸ªç‚¹ï¼š

- éæ•°ç»„å¯¹è±¡çš„å±æ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­ã€‚

```
const data = {
  a: "aaa",
  b: undefined,
  c: Symbol("dd"),
  fn: function() {
    return true;
  },
  d: "ddd"
};
JSON.stringify(data); // è¾“å‡ºï¼šï¼Ÿ
// "{"a":"aaa","d":"ddd"}"

JSON.stringify(["aaa", undefined, function aa() {
    return true
  }, Symbol('dd'),"eee"])  // è¾“å‡ºï¼šï¼Ÿ

// "["aaa",null,null,null,"eee"]"
å¤åˆ¶ä»£ç 
```

æ­£å¦‚æˆ‘ä»¬åœ¨ç¬¬ä¸€ç‰¹æ€§æ‰€è¯´ï¼Œ`JSON.stringify()` åºåˆ—åŒ–æ—¶ä¼šå¿½ç•¥ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²è¿˜æ˜¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°ï¼ˆæ•°ç»„é™¤å¤–ï¼‰ã€‚

## `JSON.stringify()` ç¬¬ä¸‰å¤§ç‰¹æ€§

- è½¬æ¢å€¼å¦‚æœæœ‰ `toJSON()` å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä»€ä¹ˆå€¼ï¼Œåºåˆ—åŒ–ç»“æœå°±æ˜¯ä»€ä¹ˆå€¼ï¼Œå¹¶ä¸”å¿½ç•¥å…¶ä»–å±æ€§çš„å€¼ã€‚

```
JSON.stringify({
    say: "hello JSON.stringify",
    toJSON: function() {
      return "today i learn";
    }
  })
// "today i learn"
å¤åˆ¶ä»£ç 
```

## `JSON.stringify()`ç¬¬å››å¤§ç‰¹æ€§

- `JSON.stringify()` å°†ä¼šæ­£å¸¸åºåˆ—åŒ– `Date` çš„å€¼ã€‚

```
JSON.stringify({ now: new Date() });
// "{"now":"2019-12-08T07:42:11.973Z"}"
å¤åˆ¶ä»£ç 
```

å®é™…ä¸Š `Date` å¯¹è±¡è‡ªå·±éƒ¨ç½²äº† `toJSON()` æ–¹æ³•ï¼ˆåŒDate.toISOString()ï¼‰ï¼Œå› æ­¤ `Date` å¯¹è±¡ä¼šè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ã€‚

## `JSON.stringify()` ç¬¬äº”å¤§ç‰¹æ€§

- `NaN` å’Œ `Infinity` æ ¼å¼çš„æ•°å€¼åŠ `null` éƒ½ä¼šè¢«å½“åš `null`ã€‚

ç›´æ¥ä¸Šä»£ç ï¼š

```
JSON.stringify(NaN)
// "null"
JSON.stringify(null)
// "null"
JSON.stringify(Infinity)
// "null"
å¤åˆ¶ä»£ç 
```

## `JSON.stringify()` ç¬¬å…­å¤§ç‰¹æ€§

å…³äºåŸºæœ¬ç±»å‹çš„åºåˆ—åŒ–ï¼š

- å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚

```
JSON.stringify([new Number(1), new String("false"), new Boolean(false)]);
// "[1,"false",false]"
å¤åˆ¶ä»£ç 
```

## `JSON.stringify()` ç¬¬ä¸ƒå¤§ç‰¹æ€§

å…³äºå¯¹è±¡å±æ€§çš„æ˜¯å¦å¯æšä¸¾ï¼š

- å…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Map/Set/WeakMap/WeakSetï¼Œä»…ä¼šåºåˆ—åŒ–å¯æšä¸¾çš„å±æ€§ã€‚

```
// ä¸å¯æšä¸¾çš„å±æ€§é»˜è®¤ä¼šè¢«å¿½ç•¥ï¼š
JSON.stringify( 
    Object.create(
        null, 
        { 
            x: { value: 'json', enumerable: false }, 
            y: { value: 'stringify', enumerable: true } 
        }
    )
);
// "{"y":"stringify"}"
å¤åˆ¶ä»£ç 
```

## `JSON.stringify()` ç¬¬å…«å¤§ç‰¹æ€§

æˆ‘ä»¬éƒ½çŸ¥é“å®ç°æ·±æ‹·è´æœ€ç®€å•ç²—æš´çš„æ–¹å¼å°±æ˜¯åºåˆ—åŒ–ï¼š`JSON.parse(JSON.stringify())`ï¼Œè¿™ä¸ªæ–¹å¼å®ç°æ·±æ‹·è´ä¼šå› ä¸ºåºåˆ—åŒ–çš„è¯¸å¤šç‰¹æ€§ä»è€Œå¯¼è‡´è¯¸å¤šçš„å‘ç‚¹ï¼šæ¯”å¦‚ç°åœ¨æˆ‘ä»¬è¦è¯´çš„å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚

```
// å¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚ 
const obj = {
  name: "loopObj"
};
const loopObj = {
  obj
};
// å¯¹è±¡ä¹‹é—´å½¢æˆå¾ªç¯å¼•ç”¨ï¼Œå½¢æˆé—­ç¯
obj.loopObj = loopObj;

// å°è£…ä¸€ä¸ªæ·±æ‹·è´çš„å‡½æ•°
function deepClone(obj) {
  return JSON.parse(JSON.stringify(obj));
}
// æ‰§è¡Œæ·±æ‹·è´ï¼ŒæŠ›å‡ºé”™è¯¯
deepClone(obj)
/**
 VM44:9 Uncaught TypeError: Converting circular structure to JSON
    --> starting at object with constructor 'Object'
    |     property 'loopObj' -> object with constructor 'Object'
    --- property 'obj' closes the circle
    at JSON.stringify (<anonymous>)
    at deepClone (<anonymous>:9:26)
    at <anonymous>:11:13
 */
å¤åˆ¶ä»£ç 
```

- å¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚

è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆç”¨åºåˆ—åŒ–å»å®ç°æ·±æ‹·è´æ—¶ï¼Œé‡åˆ°å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ä¼šæŠ›å‡ºé”™è¯¯çš„åŸå› ã€‚

## `JSON.stringify()` ç¬¬ä¹å¤§ç‰¹æ€§

æœ€åï¼Œå…³äº `symbol` å±æ€§è¿˜æœ‰ä¸€ç‚¹è¦è¯´çš„å°±æ˜¯ï¼š

- æ‰€æœ‰ä»¥ `symbol` ä¸ºå±æ€§é”®çš„å±æ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ï¼Œå³ä¾¿ `replacer` å‚æ•°ä¸­å¼ºåˆ¶æŒ‡å®šåŒ…å«äº†å®ƒä»¬ã€‚

```
JSON.stringify({ [Symbol.for("json")]: "stringify" }, function(k, v) {
    if (typeof k === "symbol") {
      return v;
    }
  })

// undefined
å¤åˆ¶ä»£ç 
```

`replacer` æ˜¯ `JSON.stringify()` çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œæˆ‘ä»¬æ¯”è¾ƒå°‘ç”¨åˆ°ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬ä¼šå¿˜è®° `JSON.stringify()` ç¬¬äºŒä¸ªã€ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œåœºæ™¯ä¸å¤šï¼Œä½†æ˜¯ç”¨çš„å¥½çš„è¯ä¼šéå¸¸æ–¹ä¾¿ï¼Œå…³äº `JSON.stringify()` ç¬¬ä¹å¤§ç‰¹æ€§çš„ä¾‹å­ä¸­å¯¹ `replacer` å‚æ•°ä¸æ˜ç™½çš„åŒå­¦å…ˆåˆ«æ€¥ï¼Œå…¶å®å¾ˆç®€å•ï¼Œæˆ‘ä»¬é©¬ä¸Šå°±ä¼šåœ¨ä¸‹é¢çš„å­¦ä¹ ä¸­å¼„æ‡‚ã€‚

# ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°

## å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•° `replacer`

`replacer` å‚æ•°æœ‰ä¸¤ç§å½¢å¼ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°æˆ–è€…ä¸€ä¸ªæ•°ç»„ã€‚ä½œä¸ºå‡½æ•°æ—¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé”®ï¼ˆkeyï¼‰å’Œå€¼ï¼ˆvalueï¼‰ï¼Œå‡½æ•°ç±»ä¼¼å°±æ˜¯æ•°ç»„æ–¹æ³• `map`ã€`filter` ç­‰æ–¹æ³•çš„å›è°ƒå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªå±æ€§å€¼éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡è¯¥å‡½æ•°ã€‚å¦‚æœ `replacer` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä»£è¡¨å°†è¢«åºåˆ—åŒ–æˆ JSON å­—ç¬¦ä¸²çš„å±æ€§åã€‚

### `replacer` ä½œä¸ºå‡½æ•°æ—¶

#### å¯ä»¥æ‰“ç ´ä¹å¤§ç‰¹æ€§çš„å¤§å¤šæ•°ç‰¹æ€§

ç¬¬äºŒä¸ªå‚æ•°`replacer` éå¸¸å¼ºå¤§ï¼Œ `replacer` ä½œä¸ºå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ‰“ç ´ä¹å¤§ç‰¹æ€§çš„å¤§å¤šæ•°ç‰¹æ€§ï¼Œæˆ‘ä»¬ç›´æ¥æ¥çœ‹ä»£ç å§ã€‚

```
const data = {
  a: "aaa",
  b: undefined,
  c: Symbol("dd"),
  fn: function() {
    return true;
  }
};
// ä¸ç”¨ replacer å‚æ•°æ—¶
JSON.stringify(data); 

// "{"a":"aaa"}"
// ä½¿ç”¨ replacer å‚æ•°ä½œä¸ºå‡½æ•°æ—¶
JSON.stringify(data, (key, value) => {
  switch (true) {
    case typeof value === "undefined":
      return "undefined";
    case typeof value === "symbol":
      return value.toString();
    case typeof value === "function":
      return value.toString();
    default:
      break;
  }
  return value;
})
// "{"a":"aaa","b":"undefined","c":"Symbol(dd)","fn":"function() {\n    return true;\n  }"}"
å¤åˆ¶ä»£ç 
```

è™½ç„¶ä½¿ç”¨ toString() æ–¹æ³•æœ‰ç‚¹è€æµæ°“çš„æ„æ€ä½†æ˜¯ä¸å¾—ä¸è¯´ç¬¬äºŒä¸ªå‚æ•°å¾ˆå¼ºå¤§ã€‚

#### ä¼ å…¥ `replacer` å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°

**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œreplacer è¢«ä¼ å…¥çš„å‡½æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡çš„ç¬¬ä¸€ä¸ªé”®å€¼å¯¹ï¼Œè€Œæ˜¯ç©ºå­—ç¬¦ä¸²ä½œä¸º key å€¼ï¼Œvalue å€¼æ˜¯æ•´ä¸ªå¯¹è±¡çš„é”®å€¼å¯¹ï¼š**

```
const data = {
  a: 2,
  b: 3,
  c: 4,
  d: 5
};
JSON.stringify(data, (key, value) => {
  console.log(value);
  return value;
})
// ç¬¬ä¸€ä¸ªè¢«ä¼ å…¥ replacer å‡½æ•°çš„æ˜¯ {"":{a: 2, b: 3, c: 4, d: 5}}
// {a: 2, b: 3, c: 4, d: 5}   
// 2
// 3
// 4
// 5

å¤åˆ¶ä»£ç 
```

#### å®ç° `map` å‡½æ•°

æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å®ƒæ¥æ‰‹å†™å®ç°ä¸€ä¸ªå¯¹è±¡çš„ç±»ä¼¼ map çš„å‡½æ•°ã€‚

```
// å®ç°ä¸€ä¸ª map å‡½æ•°
const data = {
  a: 2,
  b: 3,
  c: 4,
  d: 5
};
const objMap = (obj, fn) => {
  if (typeof fn !== "function") {
    throw new TypeError(`${fn} is not a function !`);
  }
  return JSON.parse(JSON.stringify(obj, fn));
};
objMap(data, (key, value) => {
  if (value % 2 === 0) {
    return value / 2;
  }
  return value;
});
// {a: 1, b: 3, c: 2, d: 5}
å¤åˆ¶ä»£ç 
```

### `replacer` ä½œä¸ºæ•°ç»„æ—¶

`replacer` ä½œä¸ºæ•°ç»„æ—¶ï¼Œç»“æœéå¸¸ç®€å•ï¼Œæ•°ç»„çš„å€¼å°±ä»£è¡¨äº†å°†è¢«åºåˆ—åŒ–æˆ JSON å­—ç¬¦ä¸²çš„å±æ€§åã€‚

```
const jsonObj = {
  name: "JSON.stringify",
  params: "obj,replacer,space"
};

// åªä¿ç•™ params å±æ€§çš„å€¼
JSON.stringify(jsonObj, ["params"]);
// "{"params":"obj,replacer,space"}" 
å¤åˆ¶ä»£ç 
```

## æœ‰æ„æ€å´æ²¡å•¥ç”¨çš„ç¬¬ä¸‰ä¸ªå‚æ•° `space`

`space` å‚æ•°ç”¨æ¥æ§åˆ¶ç»“æœå­—ç¬¦ä¸²é‡Œé¢çš„é—´è·ã€‚é¦–å…ˆçœ‹ä¸€ä¸ªä¾‹å­å°±æ˜¯åˆ°è¿™ä¸œè¥¿åˆ°åº•æ˜¯å¹²å•¥ç”¨çš„ï¼š

```
const tiedan = {
  name: "å¼¹é“è›‹åŒå­¦",
  describe: "ä»Šå¤©åœ¨å­¦ JSON.stringify()",
  emotion: "like shit"
};
JSON.stringify(tiedan, null, "ğŸ·");
// æ¥ä¸‹æ¥æ˜¯è¾“å‡ºç»“æœ
// "{
// ğŸ·"name": "å¼¹é“è›‹åŒå­¦",
// ğŸ·"describe": "ä»Šå¤©åœ¨å­¦ JSON.stringify()",
// ğŸ·"emotion": "like shit"
// }"
JSON.stringify(tiedan, null, 2);
// "{
//   "name": "å¼¹é“è›‹åŒå­¦",
//   "describe": "ä»Šå¤©åœ¨å­¦ JSON.stringify()",
//   "emotion": "like shit"
// }"
å¤åˆ¶ä»£ç 
```

ä¸Šé¢ä»£ç ä¸€çœ¼å°±èƒ½çœ‹å‡ºç¬¬ä¸‰ä¸ªå‚æ•°çš„ä½œç”¨äº†ï¼ŒèŠ±é‡Œèƒ¡å“¨çš„ï¼Œå…¶å®è¿™ä¸ªå‚æ•°è¿˜æ˜¯æ¯”è¾ƒé¸¡è‚‹çš„ï¼Œé™¤äº†å¥½çœ‹æ²¡å•¥ç‰¹åˆ«çš„ç”¨å¤„ã€‚æˆ‘ä»¬ç”¨ `\t`ã€ `\n` ç­‰ç¼©è¿›èƒ½è®©è¾“å‡ºæ›´åŠ æ ¼å¼åŒ–ï¼Œæ›´é€‚äºè§‚çœ‹ã€‚

- å¦‚æœæ˜¯ä¸€ä¸ªæ•°å­—, åˆ™åœ¨å­—ç¬¦ä¸²åŒ–æ—¶æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«ç¼©è¿›å¤šè¿™ä¸ªæ•°å­—å€¼çš„ç©ºæ ¼ï¼ˆæœ€å¤š10ä¸ªç©ºæ ¼ï¼‰ï¼›
- å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«å¤šç¼©è¿›è¯¥å­—ç¬¦ä¸²ï¼ˆæˆ–è¯¥å­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦ï¼‰ã€‚

# æ€»ç»“

### `JSON.stringify()` ä¹å¤§ç‰¹æ€§ï¼š

**ä¸€ã€å¯¹äº undefinedã€ä»»æ„çš„å‡½æ•°ä»¥åŠ symbol ä¸‰ä¸ªç‰¹æ®Šçš„å€¼åˆ†åˆ«ä½œä¸ºå¯¹è±¡å±æ€§çš„å€¼ã€æ•°ç»„å…ƒç´ ã€å•ç‹¬çš„å€¼æ—¶çš„ä¸åŒè¿”å›ç»“æœã€‚**

- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºå¯¹è±¡å±æ€§å€¼æ—¶ `JSON.stringify()` è·³è¿‡ï¼ˆå¿½ç•¥ï¼‰å¯¹å®ƒä»¬è¿›è¡Œåºåˆ—åŒ–
- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` ä½œä¸ºæ•°ç»„å…ƒç´ å€¼æ—¶ï¼Œ`JSON.stringify()` å°†ä¼šå°†å®ƒä»¬åºåˆ—åŒ–ä¸º `null`
- `undefined`ã€ä»»æ„çš„å‡½æ•°ä»¥åŠ `symbol` è¢« `JSON.stringify()` ä½œä¸ºå•ç‹¬çš„å€¼è¿›è¡Œåºåˆ—åŒ–æ—¶éƒ½ä¼šè¿”å› `undefined`

**äºŒã€éæ•°ç»„å¯¹è±¡çš„å±æ€§ä¸èƒ½ä¿è¯ä»¥ç‰¹å®šçš„é¡ºåºå‡ºç°åœ¨åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­ã€‚**

**ä¸‰ã€è½¬æ¢å€¼å¦‚æœæœ‰ toJSON() å‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›ä»€ä¹ˆå€¼ï¼Œåºåˆ—åŒ–ç»“æœå°±æ˜¯ä»€ä¹ˆå€¼ï¼Œå¹¶ä¸”å¿½ç•¥å…¶ä»–å±æ€§çš„å€¼ã€‚**

**å››ã€JSON.stringify() å°†ä¼šæ­£å¸¸åºåˆ—åŒ– Date çš„å€¼ã€‚**

**äº”ã€NaN å’Œ Infinity æ ¼å¼çš„æ•°å€¼åŠ null éƒ½ä¼šè¢«å½“åš nullã€‚**

**å…­ã€å¸ƒå°”å€¼ã€æ•°å­—ã€å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨è½¬æ¢æˆå¯¹åº”çš„åŸå§‹å€¼ã€‚**

**ä¸ƒã€å…¶ä»–ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Map/Set/WeakMap/WeakSetï¼Œä»…ä¼šåºåˆ—åŒ–å¯æšä¸¾çš„å±æ€§ã€‚**

**å…«ã€å¯¹åŒ…å«å¾ªç¯å¼•ç”¨çš„å¯¹è±¡ï¼ˆå¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨ï¼Œå½¢æˆæ— é™å¾ªç¯ï¼‰æ‰§è¡Œæ­¤æ–¹æ³•ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚**

**ä¹ã€æ‰€æœ‰ä»¥ symbol ä¸ºå±æ€§é”®çš„å±æ€§éƒ½ä¼šè¢«å®Œå…¨å¿½ç•¥æ‰ï¼Œå³ä¾¿ replacer å‚æ•°ä¸­å¼ºåˆ¶æŒ‡å®šåŒ…å«äº†å®ƒä»¬ã€‚**

### `JSON.stringify()` ç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°

#### å¼ºå¤§çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š

- ä½œä¸ºå‡½æ•°æ—¶ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé”®ï¼ˆkeyï¼‰å’Œå€¼ï¼ˆvalueï¼‰ï¼Œå‡½æ•°ç±»ä¼¼å°±æ˜¯æ•°ç»„æ–¹æ³• `map`ã€`filter` ç­‰æ–¹æ³•çš„å›è°ƒå‡½æ•°ï¼Œå¯¹æ¯ä¸€ä¸ªå±æ€§å€¼éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡è¯¥å‡½æ•°ï¼ˆæœŸé—´æˆ‘ä»¬è¿˜ç®€å•å®ç°è¿‡ä¸€ä¸ª `map` å‡½æ•°ï¼‰ã€‚
- å¦‚æœ `replacer` æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„çš„å€¼ä»£è¡¨å°†è¢«åºåˆ—åŒ–æˆ JSON å­—ç¬¦ä¸²çš„å±æ€§åã€‚

#### åä¸½çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š

- å¦‚æœæ˜¯ä¸€ä¸ªæ•°å­—, åˆ™åœ¨å­—ç¬¦ä¸²åŒ–æ—¶æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«ç¼©è¿›å¤šè¿™ä¸ªæ•°å­—å€¼çš„ç©ºæ ¼ï¼ˆæœ€å¤š10ä¸ªç©ºæ ¼ï¼‰ï¼›
- å¦‚æœæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™æ¯ä¸€çº§åˆ«ä¼šæ¯”ä¸Šä¸€çº§åˆ«å¤šç¼©è¿›è¯¥å­—ç¬¦ä¸²ï¼ˆæˆ–è¯¥å­—ç¬¦ä¸²çš„å‰10ä¸ªå­—ç¬¦ï¼‰ã€‚

#### æ³¨æ„ï¼š

ç¬¬ä¸€ä¸ªä¾‹å­çš„æ–¹æ¡ˆä¸‰ï¼Œæœ‰å°ä¼™ä¼´æç¤ºè¯´è¿™ä¸ªæ–¹æ¡ˆä¼šæœ‰é£é™©ï¼Œç¡®å®æ˜¯è¿™æ ·çš„(**å¯èƒ½ä¼šæŠŠå¯¹è±¡çš„å€¼ç»™æ›¿æ¢æ‰**)ã€‚å¤§å®¶æ…ç”¨å§ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹è¿™æ ·ä½¿ç”¨æ˜¯ ok çš„ã€‚å°ä¼™ä¼´ä»¬æä¾›çš„ç¬¬å››ç§æ–¹æ¡ˆè¿˜æ˜¯å¾ˆä¸é”™çš„ï¼š

```
const todayILearn = {
  _id: 1,
  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
  created_at: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
  updated_at: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)'
}
const mapObj = {
  _id: "id",
  created_at: "createdAt",
  updated_at: "updatedAt"
};
Object.fromEntries(Object.entries(todayILearn).map(([k, v]) => [mapObj[k]||k, v]))
// { 
// id: 1,
//  content: 'ä»Šå¤©å­¦ä¹  JSON.stringify()ï¼Œæˆ‘å¾ˆå¼€å¿ƒï¼',
//  createdAt: 'Mon Nov 25 2019 14:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)',
//  updatedAt: 'Mon Nov 25 2019 16:03:55 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)' 
// }
```