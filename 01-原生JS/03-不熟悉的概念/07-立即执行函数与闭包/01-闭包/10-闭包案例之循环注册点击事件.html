<!--
 * @Author: liming
 * @Date: 2021-09-02 09:55:41
 * @LastEditTime: 2021-09-02 10:03:42
 * @FilePath: \07-立即执行函数与闭包\01-闭包\10-闭包案例之循环注册点击事件.html
-->
<!DOCTYPE html>
<html lang="en">
  <head>
      
    <meta charset="UTF-8" />
      
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
      
    <title>Document</title>
  </head>

  <body>
      
    <ul class="nav">
        
      <li>榴莲</li>
          
      <li>臭豆腐</li>
          
      <li>鲱鱼罐头</li>
          
      <li>大猪蹄子</li>
    </ul>
      
    <script>
      // 闭包应用-点击li输出当前li的索引号
      // 1. 我们可以利用动态添加属性的方式
      var lis = document.querySelectorAll("li"); // 2. 利用闭包的方式得到当前小li 的索引号
      // console.log(lis);
      // for (let i = 0; i < lis.length; i++) {
      //     // 使用let就没问题
      // // for (var i = 0; i < lis.length; i++) {
      //     lis[i].onclick = function () {
      //         console.log(i);
      //         //我们这个function是异步任务，当我点击之后才会执行；
      //         //而for循环是同步任务，立马就执行了
      //         // 不管怎么点都是4
      //         //全都是4
      //     };
      // }

      for (var i = 0; i < lis.length; i++) {
        // 利用for循环创建了4个立即执行函数
        // 立即执行函数也称为小闭包，因为立即执行函数里面的任何一个函数都可以使用它的i这变量
        (function(i) {
            console.log(i);
            lis[i].onclick = function(){
                console.log(i);
            }
        })(i)
      }
    </script>
  </body>
</html>
